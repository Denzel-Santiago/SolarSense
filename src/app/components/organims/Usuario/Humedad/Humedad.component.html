<!-- Humedad.component.html -->
<div class="flex h-screen overflow-hidden">
  <app-side-nav></app-side-nav>

  <div class="flex-1 flex flex-col overflow-auto bg-gray-100">
    <div class="p-6 bg-[#1c392c] text-white text-3xl font-bold">
      SENSOR DE HUMEDAD
    </div>

    <div class="p-6 flex flex-col lg:flex-row gap-6 bg-white flex-grow">
      <!-- GrÃ¡fica -->
      <div class="flex-1">
        <p-chart [type]="humedadChart.type" [data]="humedadChart.data" class="w-full h-[300px]"></p-chart>

        <!-- Tabla de datos de humedad -->
        <div class="overflow-x-auto mt-4">
          <table class="table table-striped table-bordered w-full text-sm">
            <thead class="thead-dark">
              <tr>
                <th>ID</th>
                <th>Valor</th>
                <th>Fecha</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let sensor of sensores">
                <td>{{ sensor.id }}</td>
                <td>{{ sensor.value }}</td>
                <td>{{ sensor.timestamp }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Panel derecho con dos tarjetas y estadÃ­sticas -->
      <div class="flex flex-col gap-4 w-full lg:w-[300px]">
        <!-- Estado de conexiÃ³n -->
        <div class="p-4 rounded-xl shadow text-white text-lg font-semibold"
             [ngClass]="sensorConectado ? 'bg-green-500' : 'bg-red-500'">
          {{ sensorConectado ? 'âœ… Sensor Conectado' : 'âŒ Sensor Desconectado' }}
        </div>

        <!-- Ãšltimo valor de humedad -->
        <div class="p-4 rounded-xl shadow text-center text-lg font-bold transition-colors"
             [ngClass]="colorEstado">
          ğŸŒ§ Humedad actual: {{ humedadActual }}%
        </div>

        <!-- BotÃ³n para mostrar estadÃ­sticas -->
        <div class="mt-4">
          <button 
            class="w-full py-2 px-4 bg-blue-600 text-white font-semibold rounded-xl shadow-md transition-all duration-300 transform hover:bg-blue-700 hover:scale-105 hover:shadow-lg active:scale-95"
            (click)="obtenerStatsHumedad()"
          >
            ğŸ“Š Mostrar EstadÃ­sticas
          </button>
        </div>

        <!-- SecciÃ³n para estadÃ­sticas -->
        <div *ngIf="mostrarStats && statsData" class="bg-white p-4 rounded shadow text-sm">
          <h4 class="text-lg font-semibold mb-2">ğŸ“ˆ EstadÃ­sticas de Humedad</h4>
          <ul class="list-disc pl-5 space-y-1">
            <li><strong>Media:</strong> {{ statsData.Mean }}</li>
            <li><strong>Mediana:</strong> {{ statsData.Median }}</li>
            <li><strong>DesviaciÃ³n estÃ¡ndar:</strong> {{ statsData.STD}}</li>
            <li><strong>MÃ¡ximo:</strong> {{ statsData.Max }}</li>
            <li><strong>MÃ­nimo:</strong> {{ statsData.Min }}</li>
            <li><strong>Moda:</strong> {{ statsData.Mode }}</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
